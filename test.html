<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Contact JGB</title>

  <!-- SweetAlert2 for popups -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900 p-8">

  <h1 class="text-2xl font-bold mb-4">Contact Form</h1>

  <form id="contact-form-main" class="space-y-4 max-w-lg">
    <input type="text" name="name" placeholder="Your Name" class="w-full p-2 border rounded" required />
    <input type="email" name="email" placeholder="Your Email" class="w-full p-2 border rounded" required />
    <input type="tel" name="tel" placeholder="Your Phone Number" class="w-full p-2 border rounded" />
    <select name="why" class="w-full p-2 border rounded">
      <option value="">How can we help?</option>
      <option value="Accounting">Accounting</option>
      <option value="Tax">Tax</option>
      <option value="Consulting">Consulting</option>
    </select>
    <textarea name="comment" placeholder="Your message" class="w-full p-2 border rounded" required></textarea>
    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
      Send Message
    </button>
  </form>

  <hr class="my-10">

  <h1 class="text-2xl font-bold mb-4">Callback Request</h1>

  <form id="callback_form" class="space-y-4 max-w-lg">
    <input type="text" name="name" placeholder="Your Name" class="w-full p-2 border rounded" required />
    <input type="tel" name="tel" placeholder="Phone Number" class="w-full p-2 border rounded" required />
    <input type="email" name="email" placeholder="Email" class="w-full p-2 border rounded" required />
    <select name="contactTime" class="w-full p-2 border rounded">
      <option value="Anytime">Anytime</option>
      <option value="Morning">Morning</option>
      <option value="Afternoon">Afternoon</option>
      <option value="Evening">Evening</option>
    </select>

    <div>
      <label><input type="checkbox" name="CheckboxGroup[]" value="Email" /> Email</label>
      <label><input type="checkbox" name="CheckboxGroup[]" value="Phone" /> Phone</label>
      <label><input type="checkbox" name="CheckboxGroup[]" value="SMS" /> SMS</label>
    </div>

    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
      Request Callback
    </button>
  </form>

  <script>
    const postForm = async (formId, formSelector) => {
      const form = document.querySelector(formSelector);
      form.addEventListener('submit', async function (e) {
        e.preventDefault();
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());

        // handle checkbox group separately
        const checkboxes = form.querySelectorAll('input[name="CheckboxGroup[]"]:checked');
        if (checkboxes.length > 0) {
          data.CheckboxGroup = Array.from(checkboxes).map(cb => cb.value);
        }

        try {
          const response = await fetch('http://localhost:3000/send-email', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
          });

          const result = await response.json();
          if (result.success) {
            Swal.fire({
              icon: 'success',
              title: 'Message Sent!',
              text: 'Thank you! Weâ€™ll get back to you shortly.',
              confirmButtonColor: '#3AA142'
            });
            form.reset();
          } else {
            throw new Error(result.message || 'Unknown error');
          }
        } catch (error) {
          console.error('Send Error:', error);
          Swal.fire({
            icon: 'error',
            title: 'Oops!',
            text: 'Failed to send message. Please try again.',
            confirmButtonColor: '#854983'
          });
        }
      });
    };

    postForm('contactForm', '#contact-form-main');
    postForm('callbackForm', '#callback_form');
  </script>

</body>
</html>
